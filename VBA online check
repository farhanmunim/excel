'<--- main --->

Private Declare PtrSafe Function InternetGetConnectedState Lib "wininet.dll" _
    (ByRef dwFlags As Long, ByVal dwReserved As Long) As Long
Function IsOnline() As Boolean
    Dim dwFlags As Long
    IsOnline = InternetGetConnectedState(dwFlags, 0&)
End Function

'<--- example --->

Sub test()
    Dim sht As Worksheet
    Set sht = ThisWorkbook.Worksheets("Sheet1")
    
    Dim filePath As String
    Dim saveDesktop As String
    Dim desktopPath As String
    Dim specificPath As String
    Dim environUser As String
    
    saveDesktop = sht.Range("C3").Value
    environUser = Environ("UserName")
    desktopPath = "C:\Users\" & environUser & "\Desktop\"
    
    'get the correct filepath
    If saveDesktop = "Yes" Then
        If IsOnline() Then
            filePath = CreateObject("WScript.Shell").SpecialFolders("Desktop") & "\"
        Else
            filePath = desktopPath
        End If
    Else
        specificPath = sht.Range("C4").Value
        
        On Error Resume Next
        If Dir(specificPath, vbDirectory) = "" Then
            If IsOnline() Then
                filePath = CreateObject("WScript.Shell").SpecialFolders("Desktop") & "\"
            Else
                filePath = desktopPath
            End If
        Else
            filePath = specificPath
        End If
        On Error GoTo 0
    End If
    
    'main function
End Sub
